-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- THE FORGE - AUTO RE-EXECUTE + REJOIN SYSTEM
-- Automatically re-executes your script when you rejoin or get kicked
-- Created by Rafso [literalh]
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local GuiService = game:GetService("GuiService")
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CONFIGURATION
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local CONFIG = {
    SCRIPT_URL = "https://raw.githubusercontent.com/HellishHumanoid/TF/refs/heads/main/theforgeautodetect", -- Your main script URL
    AUTO_REJOIN_ENABLED = true,
    AUTO_REEXECUTE_ENABLED = true,
    ANTI_AFK_ENABLED = true,
    QUEUE_SUPPORT = true, -- Auto-queue support
    NOTIFICATION_ENABLED = true,
}

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- NOTIFICATION SYSTEM
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function sendNotification(title, text, duration)
    if not CONFIG.NOTIFICATION_ENABLED then return end
    
    pcall(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = title,
            Text = text,
            Duration = duration or 5,
        })
    end)
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- SCRIPT STORAGE (FOR RE-EXECUTION)
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Store the script in a global variable so it persists across teleports
if not getgenv().ForgeScriptLoaded then
    getgenv().ForgeScriptLoaded = true
    getgenv().ForgeScriptContent = nil
    getgenv().ForgeAutoReexecute = true
    print("âœ… Forge Auto Re-Execute System Initialized")
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- SCRIPT LOADER
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function loadMainScript()
    sendNotification("The Forge", "Loading main script...", 3)
    
    local success, result = pcall(function()
        -- Try to load from cache first
        if getgenv().ForgeScriptContent then
            print("ğŸ“¦ Loading script from cache...")
            local loadFunc = loadstring(getgenv().ForgeScriptContent)
            if loadFunc then
                loadFunc()
                return true
            end
        end
        
        -- Load from URL
        print("ğŸŒ Downloading script from GitHub...")
        local scriptContent = game:HttpGet(CONFIG.SCRIPT_URL)
        
        if scriptContent and scriptContent ~= "" then
            -- Cache the script for future use
            getgenv().ForgeScriptContent = scriptContent
            
            local loadFunc, loadErr = loadstring(scriptContent)
            
            if loadFunc then
                loadFunc()
                return true
            else
                error("Failed to compile script: " .. tostring(loadErr))
            end
        else
            error("Failed to retrieve script from GitHub")
        end
    end)
    
    if success then
        sendNotification("Success!", "Main script loaded!", 4)
        print("âœ… Main script loaded successfully")
    else
        sendNotification("Load Failed", "Retrying in 5 seconds...", 5)
        warn("âŒ Script Load Error: " .. tostring(result))
        
        -- Retry after 5 seconds
        task.wait(5)
        loadMainScript()
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- AUTO-REJOIN SYSTEM (ENHANCED)
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function setupAutoRejoin()
    if not CONFIG.AUTO_REJOIN_ENABLED then return end
    
    sendNotification("Auto-Rejoin", "System enabled!", 3)
    print("ğŸ”„ Auto-Rejoin system enabled")
    
    -- Method 1: Error message detection
    GuiService.ErrorMessageChanged:Connect(function(errorMessage)
        if errorMessage and errorMessage ~= "" then
            print("âš ï¸ Error detected: " .. errorMessage)
            sendNotification("Auto-Rejoin", "Rejoining server...", 3)
            
            task.wait(0.5)
            
            if CONFIG.QUEUE_SUPPORT then
                -- Queue support
                TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
            else
                TeleportService:Teleport(game.PlaceId, LocalPlayer)
            end
        end
    end)
    
    -- Method 2: Kick detection
    LocalPlayer.Kicked:Connect(function(reason)
        print("âš ï¸ Kicked from server: " .. tostring(reason))
        sendNotification("Auto-Rejoin", "Rejoining after kick...", 3)
        
        task.wait(0.5)
        TeleportService:Teleport(game.PlaceId, LocalPlayer)
    end)
    
    -- Method 3: Core GUI detection (for some executors)
    pcall(function()
        local coreGui = game:GetService("CoreGui")
        local reconnectEvent = coreGui.DescendantAdded:Connect(function(gui)
            if gui.Name == "ErrorPrompt" or gui.Name == "DisconnectPrompt" then
                print("âš ï¸ Disconnect prompt detected")
                task.wait(0.5)
                TeleportService:Teleport(game.PlaceId, LocalPlayer)
            end
        end)
    end)
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- AUTO RE-EXECUTE ON SERVER JOIN
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function setupAutoReexecute()
    if not CONFIG.AUTO_REEXECUTE_ENABLED then return end
    
    print("ğŸ” Auto Re-Execute system enabled")
    
    -- Detect when player is added to a new server
    LocalPlayer.OnTeleport:Connect(function(State)
        if State == Enum.TeleportState.Started then
            print("ğŸš€ Teleport started - Preparing to re-execute...")
            sendNotification("Teleporting", "Will re-execute on arrival", 3)
            
            -- Queue the script for execution after teleport
            queue_on_teleport([[
                task.wait(5) -- Wait for game to fully load
                
                -- Re-execute the auto re-execute script
                loadstring(game:HttpGet('https://raw.githubusercontent.com/HellishHumanoid/TF/refs/heads/main/AUTO_REEXECUTE_SCRIPT'))()
            ]])
            
        elseif State == Enum.TeleportState.InProgress then
            print("ğŸ“¡ Teleport in progress...")
            
        elseif State == Enum.TeleportState.Failed then
            print("âŒ Teleport failed - Retrying...")
            task.wait(2)
            TeleportService:Teleport(game.PlaceId, LocalPlayer)
        end
    end)
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ANTI-AFK SYSTEM
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function setupAntiAFK()
    if not CONFIG.ANTI_AFK_ENABLED then return end
    
    sendNotification("Anti-AFK", "System enabled!", 3)
    print("â° Anti-AFK system enabled")
    
    -- Prevent idle kick
    LocalPlayer.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
        print("ğŸ•’ Anti-AFK: Prevented idle kick")
    end)
    
    -- Additional activity simulation every 5 minutes
    task.spawn(function()
        while CONFIG.ANTI_AFK_ENABLED do
            task.wait(300) -- 5 minutes
            
            pcall(function()
                VirtualUser:CaptureController()
                VirtualUser:ClickButton2(Vector2.new())
            end)
            
            print("ğŸ•’ Anti-AFK: Activity simulated")
        end
    end)
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- MAIN EXECUTION
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("ğŸ›¡ï¸ THE FORGE - AUTO RE-EXECUTE + REJOIN SYSTEM")
print("Created by Rafso [literalh]")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

sendNotification("The Forge", "Initializing systems...", 3)

-- Setup systems
task.spawn(function()
    pcall(setupAutoRejoin)
end)

task.spawn(function()
    pcall(setupAutoReexecute)
end)

task.spawn(function()
    task.wait(0.5)
    pcall(setupAntiAFK)
end)

-- Wait for character to load
if not LocalPlayer.Character then
    print("â³ Waiting for character to load...")
    LocalPlayer.CharacterAdded:Wait()
end

-- Wait for game to fully load
task.wait(3)

-- Execute main script
print("ğŸš€ Executing main script...")
loadMainScript()

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("âœ… All systems initialized successfully!")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- GLOBAL FUNCTIONS (FOR MANUAL CONTROL)
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

getgenv().ForgeRejoin = function()
    print("ğŸ”„ Manual rejoin triggered")
    TeleportService:Teleport(game.PlaceId, LocalPlayer)
end

getgenv().ForgeReload = function()
    print("ğŸ”„ Manual reload triggered")
    loadMainScript()
end

getgenv().ForgeToggleNotifications = function(enabled)
    CONFIG.NOTIFICATION_ENABLED = enabled
    print("ğŸ”” Notifications " .. (enabled and "enabled" or "disabled"))
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- END OF AUTO RE-EXECUTE + REJOIN SYSTEM
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
